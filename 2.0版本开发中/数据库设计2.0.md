@[toc]

---
### 一. 数据库设计
数据库db_fdog_im
#### 1. 用户注册表
首先，用户会进行注册   提供手机号，验证码，时间戳

tb_phone_register(账号注册)

| 字段 | 类型 |说明|
|--|--|--|
| phone | VARCHAR(13) | 手机号 |
| code | VARCHAR(7) | 验证码  |
| time | VARCHAR(15) | 时间戳 |


注册成功，提醒用户设置相关信息

手机号，fdog账号，邮箱，用户名，密码，性别，年龄，地区，职业，个性签名，头像，

tb_user_basic_info(账户基础信息)
| 字段 | 类型  | 说明 |
|--|--|--|
| fdog_id |  | fdog账号 |
| phone |  | 手机号 |
| mail |  | 邮箱 |
| user |  | 用户名 |
| password |  | 密码 |
| sex |  | 性别 |
| age |  | 年龄 |
| region |  | 地区 |
| occupation |  | 职业 |
| personal_signature |  |个性签名|
| user_icon |  |头像|

注册时间，第几个注册的，等级，会员，当前分组数，可以添加分组的数，可以添加的人数，可以创建的群以及群规模

tb_user_additional_info(账户附加信息)
| 字段 | 类型 | 说明 |
|--|--|--|
| fdog_id |  | fdog账号 |
| register_time |  |注册时间|
| register_serial_number |  | 注册序号 |
| fdog_grade |  | 账号等级 |
| fdog_vip |  | 是否会员 |
|  fdog_vip_grade |   | 会员等级  |
| group_sum |  | 分组规模 |
| group_number |  | 当前分组数 |
| friend_sum |  | 好友规模 |
| friend_number |  | 当前好友数 |
| grouping_fifty_sum |  | 50人群规模 |
| grouping_fifty_number |  | 50人群当前数 |
| grouping_hundred_sum |  | 100人群规模 |
| grouping_hundred_number |  | 100人群当前数 |


tb_user_line_info用户在线信息

ip地址，端口，地区，fdog账号，当前真实在线状态，当前伪装状态，最后一次登录

| 字段 | 类型 | 说明 |
|--|--|--|
| addr |  | ip地址 |
| port |  | 端口 |
| region |  | 地区 |
| fdog_id |  | fdog账号 |
| line_status_true |  | 当前真实在线状态 |
| line_status |  | 当前伪装状态 |
| sign_in_end |  | 最后一次登录 |



用户登录之后就要创建分组，添加好友，创建群，等等

tb_group(分组表)
一个新账号，默认有一个我的好友分组。还有分组的顺序，如果用户改变分组顺序，要保证好友的正确性

|字段| 类型 | 说明 |
|--|--|--|
| fdog_id |  | fdog账号 |
| group_name |  | 分组昵称 |
| group_name_id |  | 分组id |
|group_order  |  | 分组顺序 |

tb_friend(好友表)

|字段| 类型 | 说明 |
|--|--|--|
| fdog_group_id |  | 账号加分组ID确定好友出现位置 |
| friend_name_fdog |  | 好友网名+fdog账号 |
| friend_remarks |  | 好友备注(默认对方昵称) |
| friend_time |  | 添加好友时间 |
| friend_special |  | 是否特别关心 |

个人聊天记录表

聊天时间，发起人，接收人，消息id  消息类型（'类型 1：文字；47：emoji；43：音频；436207665：红包；49：文件；48：位置；3：图片',）， 消息内容

| 字段 | 类型 | 说明 |
|--|--|--|
|  |  | 聊天时间 |
|  |  | 发起人 |
|  |  | 接收人 |
|  |  | 聊天id |
|  |  | 聊天类型 |
|  |  | 聊天内容 |


tb_grouping(群表)

群号，群昵称，群介绍，创建时间，创建人，头像，群地点，群标签，群管理员，群成员

| 字段 | 类型 | 说明 |
|--|--|--|
| grouping_id |  | 群号 |
| grouping_name |  | 群昵称 |
| grouping_introduction |  | 群介绍 |
| grouping_icon |  | 群头像 |
| grouping_location |  | 群地点 |
| grouping_label |  | 群标签 |
| grouping_member_sum |  | 群规模人数 |
| grouping_member_number |  | 群当前人数 |
| grouping_admin_number |  | 群管理人数 |
| grouping_admin_id |  | 群管理员 |
| grouping_member_id |  | 群成员 |
| grouping_time |  | 建立时间 |
| grouping_fdog_id |  | 创建人 |


群聊天记录表

tb_grouping_xxxxxxxx

群id为表名，用时新建

成员权限，发送者，发送时间，信息类型，消息内容，是否@
| 字段 | 类型 | 说明 |
|--|--|--|
|  |  | 成员权限 |
|  |  | 发送者 |
|  |  | 发送时间 |
|  |  | 信息类型 |
|  |  | 信息内容 |
|  |  | 屏蔽某人 |
|  |  | @类型 |


添加好友记录表：

发送申请表

添加时间，同意/拒绝时间，备注，添加的分组

接受申请表

消息时间，同意/拒绝时间，备注，添加的分组
